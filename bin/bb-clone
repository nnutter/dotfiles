#!/usr/bin/env bash

set -o errexit

REPO_NAME="$1"
shift

REPO_BASE_DIR="$HOME/src/bitbucket.gsc.wustl.edu"
REPO_DIR="$REPO_BASE_DIR/$REPO_NAME"
REPO_URL="ssh://git@bitbucket.gsc.wustl.edu:7999/${REPO_NAME}.git"

mkdir -p "$REPO_DIR"
git clone "$@" "${REPO_URL}" "$REPO_DIR" \
    || ( rmdir -p "$(dirname $REPO_DIR)" 2> /dev/null && false )
